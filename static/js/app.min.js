$().ready(function(){function t(){let o=new Date;console.log("capture_"+o.getTime());$("#resultat").hide(),$("#chargement").show(),$.get("/detect",{},function(e){for(console.log(e),objets=JSON.parse(e),types="",result="",color_classes=["success","primary","danger","warning","info","dark"],color_gradient=["ff0000","cc6600","ffff00","99cc00","009933"],i=0;i<objets.length;i++){for(result+="<tr>",color_class=color_classes[Math.floor(Math.random()*color_classes.length)],types+='<span class="badge mx-2 bg-'+color_class+'">'+objets[i].nom+"</span>",result=(result+="<td>"+objets[i].nom+"</td>")+("<td>"+objets[i].nombre+"</td>")+"<td>",j=0;j<objets[i].items.length;j++)valeur_percent=parseFloat(100*objets[i].items[j].confidence),width=parseInt(100*objets[i].items[j].confidence),valeur=valeur_percent.toFixed(2),progress_color="",width<=60?progress_color=color_gradient[0]:width<=70&&60<width?progress_color=color_gradient[1]:width<=80&&70<width?progress_color=color_gradient[2]:width<=90&&80<width?progress_color=color_gradient[3]:90<width&&(progress_color=color_gradient[4]),console.log("progress_color"+progress_color),result+='<div class="row"><div class="row"><div class="col-3"><span class="badge bg-primary">'+(j+1)+' </span></div><div class="col-9"><div class="progress m-1"><div class="progress-bar progress-bar-animated" style="width:'+valeur+"%; background-color:#"+progress_color+'" role="progressbar" aria-valuenow="'+valeur+'" aria-valuemin="0" aria-valuemax="100">'+valeur+"%</div></div></div></div></div>";result+="</td></tr>"}objets.length<1&&(result+=' <tr class="text-center"><td colspan="3" >Aucune objets détecté</td></tr>'),$("#tbl").html(result),console.log(objets),target="#captured";var e=new Date,t=($("#resultat").show(),$("#chargement").hide(),$(target).attr("src","static/img/result.jpg?"+e.getTime()),console.log("{{url_for('static',filename='img/result.jpg')}}?"),$("#objets_nb").text(objets.length),$("#types").html(types),(e.getTime()-o.getTime())/1e3);$("#calcul_duration").text(t+" secondes"),console.log("response_"+e.getTime())})}$("#chargement").hide(),$(document).on("click","#js-capture",function(){t()}),document.addEventListener("keyup",function(e){"Enter"!=e.code&&"KeyC"!=e.code&&"Space"!=e.code||t()})});